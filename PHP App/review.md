# PHP App ① レビュー

## 全般

### 以下のaタグのリンクを押下した際にedit.phpの$_GETにどんな値が格納されるか説明してください。

```html
<a href="edit.php?todo_id=123&todo_content=焼肉">更新</a>
```
* $_GET には todo_id=123のtodo_contentを焼肉に変更した値が連想配列に格納されます。

### 以下のフォームの送信ボタンを押下した際にstore.phpの$_POSTにどんな値が格納されるか説明してください。

```html
<form action="store.php" method="post">
    <input type="text" name="id" value="123">
		<textarea　name="content">焼肉</textarea>
    <button type="submit">送信</button>
</form>
```
* store.phpの$_POSTに id=>"123", content=>"焼肉"の連想配列が格納されます。
### `require_once()` は何のために記述しているか説明してください。
* 他のファイルで記述した内容を参照するために利用しています。また、一度だけimportするため何度も読み込む必要が無いため軽く処理できます。
### `savePostedData($post)`は何をしているか説明してください。
* 現在リクエストされているページの直前のページのurlを取得し、それに合わせてタスク新規作成、タスク削除、タスクの編集など適切な処理を実行している。
### `header('location: ./index.php')`は何をしているか説明してください。
* この場合はクライアントを同一階層にあるindex.phpに遷移させています。
HTTPレスポンスのヘッダーを設定することができ、locationで新しいURLに遷移できます。
### `getRefererPath()`は何をしているか説明してください。
* 現在のページにリクエストを送信した直前のページのpathを返しています。
これによりsavePostedDataが正常に動きます。$_SERVERはserverName、ホスト名などの情報を持つ配列で、この連想配列中のHTTP_REFERERのvalueを取り出し、その中のパスを取り出して、返り値として返しています。
### `connectPdo()` の返り値は何か、またこの記述は何をするための記述か説明してください。
* PDOクラスのオブジェクトを返り値に設定しています。この記述は、データベースと接続するためのもので、mysql以外のデータベースにも接続可能です。
### `try catch`とは何か説明してください。
* try内でエラーが発生したときにcatchでそれを受け取り、処理するものです。エラーが発生した際にプログラムが強制終了するのを防ぎ、適切にエラー処理することができます。
### Pdoクラスをインスタンス化する際に`try catch`が必要な理由を説明してください。
* データベースが正常に動いていない時、パスワードの変更があった時など、特定の条件下でエラーが発生する可能性があるためtry catchが必要になります。
## 新規作成

### `createTodoData($post)`は何をしているか説明してください。
* まず、new.phpでsubmitされた内容をstore.phpで受け取り、それをfunctions.phpに渡しています。function.phpでは受け取った連想配列のcontentキーの要素をcreateTodoDataの引数として更に渡しています。createTodoDataではデータベースと接続して、受け取った要素をtodosターブルのcontentとして挿入しています。
## 一覧

### `getTodoList()`の返り値について説明してください。
* todosターブルからdeleted_atがnullでないものをを2次元の連想配列に格納されれたものが戻り値となっています。
### `<?= ?>`は何の省略形か説明してください。
* <?php echo ?>の省略形です。
## 更新

### `getSelectedTodo($_GET['id'])`の返り値は何か、またなぜ`$_GET['id']` を引数に渡すのか説明してください。
* 引数で渡したidと一致するtodosテーブルのcontentが返り値になります。
`$_GET['id']`を引数に渡す理由はindex.phpで選択したtodosのレコードを編集画面で表示するためです。
### `updateTodoData($post)`は何をしているか説明してください。
* 引数で渡したidとcontentを用いてcontentを対応するtodosテーブルのカラムに代入しています。またその際は、idが合致するカラム先に挿入します。
## 削除

### `deleteTodoData($id)`は何をしているか説明してください。
* index.phpで選択したtodosのレコードに対し、論理削除を行っています。削除時には、deleted_atに現在の時刻を入力しています。
### `deleted_at`を現在時刻で更新すると一覧画面からToDoが非表示になる理由を説明してください。
* index.phpでtodosテーブルの一覧を表示する際に利用したgetTodoListでは、deleted_atがnullのものだけを取得するからです。
### 今回のように実際のデータを削除せずに非表示にすることで削除されたように扱うことを〇〇削除というか。
* 論理削除といいます。
### 実際にデータを削除することを〇〇削除というか。
* 物理削除です。
### 前問のそれぞれの削除のメリット・デメリットについて説明してください。
* 論理削除のメリットは復元可能であるということ、削除の詳細を記録できること、デメリットはレコードを表示する際などにＳＱＬ分が少し煩雑になること、データが膨張することです。
* 物理削除のメリットは完全に削除するため、誤ってクエリ操作をする心配がないこと、不要なデータが残らないため軽くなること、デメリットは復元が困難であるということ、です。